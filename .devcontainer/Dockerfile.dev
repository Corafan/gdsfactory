FROM ghcr.io/mamba-org/micromamba:latest

# Expose the necessary ports for klive
EXPOSE 8082 8083 8888

USER root
# Update and install dependencies
RUN apt-get update --yes && \
    apt-get install --yes --no-install-recommends \
        make \
        git \
        python3-gmsh \
        klayout \
        gmsh && \
    # apt-add-repository ppa:elmer-csc-ubuntu/elmer-csc-ppa && \
    # apt-get update --yes && \
    # apt-get install --yes elmerfem-csc && \
    rm -rf /var/lib/apt/lists/*

USER $MAMBA_USER
COPY  --chmod=777 . ${HOME}
RUN pip install --no-cache notebook jupyterlab
RUN pip install .[full]
